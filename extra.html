<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Una API para un examen AKI</title>
        <style>
            body {
                font-family: "Lucida Grande", monospace;
            }
        </style>
    </head>
    <body>
        <h1>ðŸ¤– Onegaishimasu!</h1>

        <p>
            Este robot te presentarÃ¡ desafÃ­os de todos los Kyu previos al que puedas escoger, y tambiÃ©n podrÃ­a considerar un desafÃ­o del Kyu que sigue enmediatamente despuÃ©s; esto porque en cada prueba puede preguntarse por todo lo pasadao
            y, para comprobar una preparaciÃ³n sobresaliente, uno del que sigue.
        </p>

        <p>Seleccione su Kyu y pruebe</p>
        <form id="kyu">
            <select name="nivel">
                <option value="0" selected>Seleccione el Kyu</option>
                <option value="5">5Âº Kyu</option>
                <option value="4">4Âº Kyu</option>
                <option value="3">3Âº Kyu</option>
                <option value="2">2Âº Kyu</option>
                <option value="1">1Âº Kyu</option>
            </select>
            <button onClick="boton()">Â¡Ponme a prueba!</button>
        </form>
        <div id="seleccion">
            <h2>Escoge un Kyu</h2>
            <details>
                <summary>Respuestaâ€¦</summary>
                <div id="respuesta"></div>
            </details>
        </div>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"
            integrity="sha512-dfX5uYVXzyU8+KHqj8bjo7UkOdg18PaOtpa48djpNbZHwExddghZ+ZmzWT06R5v6NSk3ZUfsH6FNEDepLx9hPQ=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        ></script>

        <script>
            const respuesta = document.querySelector("#respuesta");
            const nombre = document.querySelector("h2");
            var datos, val, tope;
            var r = 0;


            function boton (){
                val = document.querySelector('select[name="nivel"]').value;
                if(val == 0){
                    nombre.innerHTML == "Ya po, escoge un Kyu"
                }else if (val == 5) {
                    tope = 29;
                    document.querySelectorAll("option").forEach(x => x.removeAttribute('selected'));
                    document.querySelector('option[value="1"').setAttribute('selected', true);
                } else if (val == 4) {
                    tope = 43;
                    document.querySelectorAll("option").forEach(x => x.removeAttribute('selected'));
                    document.querySelector('option[value="2"').setAttribute('selected', true);
                } else if (val == 3) {
                    tope = 72;
                    document.querySelectorAll("option").forEach(x => x.removeAttribute('selected'));
                    document.querySelector('option[value="3"').setAttribute('selected', true);
                } else {
                    tope = 108;
                }
                console.log(val);
                random(tope);
            }
            function random(total){
              let rand = Math.random() * total;
              rand = Math.floor(rand);
              console.log(rand);
              r = rand;


Papa.parse("https://raw.githubusercontent.com/profesorfaco/aki/main/data.csv", {
    download: true,
    header: true,
    complete: function (results) { 
        datos = results.data;

            if (datos[r].tissier !== "") {
                respuesta.innerHTML = `<p>SegÃºn Tissier, esto se resuelve de la siguiente manera:</p><iframe width="560" height="315" title="YouTube video player" frameborder="0" src="${video(
                    datos[r].tissier
                )}" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`;
            } else if (datos[r].tissier == "" && datos[r].otro !== "") {
                respuesta.innerHTML = `<p>No aparece en el video de Tissier, pero encontrÃ©:</p><iframe width="560" height="315" title="YouTube video player" frameborder="0" src="${video(
                    datos[r].otro
                )}" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`;
            } else {
                respuesta.innerHTML = "<p>No hay video. El robot lo siente mucho.</p>";
            }



    }

})



            }

        function video(v) {
            var final;
            var str = v;
            var res = str.split("/");
            var embeddedUrl = "https://www.youtube.com/embed/" + res[3];
            if (embeddedUrl.includes("?t")) {
                final = embeddedUrl.replace("?t=", "?start=") + "&feature=oembed";
            } else {
                final = embeddedUrl;
            }
            return final;
        }





        </script>
    </body>
</html>